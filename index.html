<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AGCI</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-orbit-controls@1.0.0/dist/aframe-orbit-controls.min.js"></script>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- Title -->
    <div id="title">AGCI</div>

    <!-- 3D Scene -->
    <a-scene background="color: #000000" embedded>
      <a-assets>
        <a-asset-item id="flowerModel" src="lowpoly_tree.glb"></a-asset-item>
      </a-assets>

      <!-- Tree Model with idle rotation -->
      <a-entity 
        id="treeModel"
        gltf-model="#flowerModel"
        position="0 0 -3"
        rotation="0 180 0"
        scale="1 1 1"
        animation="property: rotation; to: 0 540 0; loop: true; dur: 20000; easing: linear"
      ></a-entity>

      <!-- Lighting -->
      <a-entity light="type: ambient; color: #FFFFFF; intensity: 0.6"></a-entity>
      <a-entity light="type: directional; color: #FFFFFF; intensity: 0.8" position="1 1 0.5"></a-entity>

      <!-- Orbiting Camera -->
      <a-entity 
        id="orbitRig"
        position="0 1.6 4"
        orbit-controls="
          target: 0 0 -3;
          enableDamping: true;
          dampingFactor: 0.125;
          rotateSpeed: 0.25;
          minDistance: 1;
          maxDistance: 10;
          autoRotate: false;
          enableZoom: true;
        "
      >
        <a-camera></a-camera>
      </a-entity>
    </a-scene>

    <!-- Caption -->
    <div id="caption">
      <p>This tree reflects Aarhusâ€™ environmental health for today.</p>
      <p><a href="https://public.tableau.com/app/profile/pradana.aditya/viz/HowstheWeatherHowsMyMood/db" target="_blank">ðŸŒ¿ Explore the dashboard here!</a></p>
    </div>

    <!-- JS to stop rotation on user interaction -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const tree = document.getElementById('treeModel');

        const stopRotation = () => {
          if (tree.hasAttribute('animation')) {
            tree.removeAttribute('animation');
            window.removeEventListener('touchstart', stopRotation);
            window.removeEventListener('mousedown', stopRotation);
          }
        };

        window.addEventListener('touchstart', stopRotation);
        window.addEventListener('mousedown', stopRotation);
      });
    </script>
  </body>
</html>